<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Harf ve Kelime Oyunu</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      text-align: center;
      background: linear-gradient(135deg, #ffccd5, #c9f5ff);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 20px;
      /* overflow: hidden kaldırıldı - sayfa kaydırılabilir olacak */
    }
    
    .container {
      width: 95vw;
      max-width: 1600px;
      background-color: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      border: 8px solid #ff9ebb;
      display: flex;
      flex-direction: column;
      margin: 20px auto;
      /* min-height ekleyerek içerik az olsa bile container'ın yeterli yüksekliği olmasını sağlıyoruz */
      min-height: 600px;
    }
    
    h1 {
      color: #ff6b9d;
      font-size: 2.8rem;
      margin-bottom: 15px;
      text-shadow: 2px 2px 0 #ffd1dc;
    }
    
    .subtitle {
      color: #5fa8ff;
      font-size: 1.3rem;
      margin-bottom: 25px;
    }
    
    .game-layout {
      display: flex;
      flex: 1;
      gap: 30px;
      min-height: 500px;
    }
    
    .left-panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }
    
    .right-panel {
      flex: 2;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }
    
    .alphabet {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      margin-bottom: 15px;
      background-color: #e6f7ff;
      padding: 20px;
      border-radius: 15px;
      border: 3px solid #5fa8ff;
      /* flex: 1 kaldırıldı - içerik kadar yer kaplasın */
    }
    
    .letter-btn {
      width: 55px;
      height: 55px;
      font-size: 1.6rem;
      font-weight: bold;
      background-color: #ffd1dc;
      border: 3px solid #ff9ebb;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      flex-shrink: 0;
    }
    
    .letter-btn:hover {
      background-color: #ffb6c1;
      transform: scale(1.1);
    }
    
    .letter-btn.selected {
      background-color: #7ae582;
      border-color: #5ac763;
      color: white;
    }
    
    .selected-letters {
      font-size: 1.4rem;
      margin: 15px 0;
      color: #5fa8ff;
      font-weight: bold;
      min-height: 50px;
      background-color: #f0f8ff;
      padding: 12px;
      border-radius: 12px;
      border: 2px solid #5fa8ff;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    button {
      font-size: 1.4rem;
      padding: 16px 30px;
      margin: 10px;
      cursor: pointer;
      border: none;
      border-radius: 15px;
      transition: all 0.3s;
      font-weight: bold;
      flex-shrink: 0;
    }
    
    #startBtn {
      background-color: #5fa8ff;
      color: white;
      box-shadow: 0 4px 0 #3a7bd5;
      font-size: 1.5rem;
      padding: 18px 40px;
    }
    
    #startBtn:hover {
      background-color: #4a97f5;
      transform: translateY(-2px);
    }
    
    #startBtn:active {
      transform: translateY(2px);
      box-shadow: 0 2px 0 #3a7bd5;
    }
    
    #submitBtn {
      background-color: #7ae582;
      color: white;
      box-shadow: 0 4px 0 #5ac763;
      font-size: 1.6rem;
      padding: 20px 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px auto;
    }
    
    #submitBtn:hover {
      background-color: #68d571;
      transform: translateY(-2px);
    }
    
    #submitBtn:active {
      transform: translateY(2px);
      box-shadow: 0 2px 0 #5ac763;
    }
    
    #nextBtn {
      background-color: #ffb347;
      color: white;
      box-shadow: 0 4px 0 #e69500;
      font-size: 1.6rem;
      padding: 20px 45px;
      display: none;
      align-items: center;
      justify-content: center;
      margin: 20px auto;
    }
    
    #nextBtn:hover {
      background-color: #ffa235;
      transform: translateY(-2px);
    }
    
    #nextBtn:active {
      transform: translateY(2px);
      box-shadow: 0 2px 0 #e69500;
    }
    
    .game-area {
      flex: 1;
      display: none;
      flex-direction: column;
      justify-content: space-between;
    }
    
    .question-section {
      flex: 2;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    
    .question-type {
      font-size: 1.6rem;
      color: #5fa8ff;
      margin-bottom: 20px;
      font-weight: bold;
    }
    
    .question {
      font-size: 2.8rem;
      color: #ff6b9d;
      margin: 20px 0;
      padding: 30px;
      background-color: #fff9fc;
      border-radius: 20px;
      border: 4px dashed #ff9ebb;
      min-height: 180px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      width: 100%;
      max-width: 800px;
    }
    
    .answer-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 20px;
    }
    
    .input-container {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    #answer {
      font-size: 1.8rem;
      padding: 18px;
      text-align: center;
      width: 350px;
      border: 4px solid #ff9ebb;
      border-radius: 15px;
      background-color: #fff9fc;
    }
    
    #clearBtn {
      background-color: #ff6b6b;
      color: white;
      width: 60px;
      height: 60px;
      font-size: 1.6rem;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    #clearBtn:hover {
      background-color: #ff5252;
    }
    
    .selected-letters-answer {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      max-width: 500px;
      margin-bottom: 15px;
    }
    
    .answer-letter {
      width: 50px;
      height: 50px;
      font-size: 1.5rem;
      font-weight: bold;
      background-color: #ffd1dc;
      border: 3px solid #ff9ebb;
      border-radius: 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    
    .answer-letter:hover {
      background-color: #ffb6c1;
      transform: scale(1.1);
    }
    
    #message {
      margin-top: 20px;
      font-size: 1.8rem;
      font-weight: bold;
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .correct {
      color: #7ae582;
    }
    
    .wrong {
      color: #ff6b6b;
    }
    
    .stats {
      display: flex;
      justify-content: space-around;
      margin-top: 20px;
      background-color: #e6f7ff;
      padding: 20px;
      border-radius: 15px;
      border: 3px solid #5fa8ff;
    }
    
    .stat-box {
      flex: 1;
      padding: 15px;
    }
    
    .stat-value {
      font-size: 2.5rem;
      font-weight: bold;
      color: #ff6b9d;
    }
    
    .stat-label {
      font-size: 1.2rem;
      color: #5fa8ff;
    }
    
    #wrongMark {
      font-size: 150px;
      color: red;
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10000;
      text-shadow: 4px 4px 0 rgba(0,0,0,0.3);
    }
    
    .fireworks {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      background: transparent;
      z-index: 9999;
    }
    
    .tick-icon {
      font-size: 2.2rem;
      margin-right: 12px;
    }
    
    .speaker-icon {
      font-size: 2.4rem;
      margin-right: 12px;
    }
    
    .sound-btn {
      background-color: #ffb347;
      color: white;
      box-shadow: 0 4px 0 #e69500;
      margin-top: 15px;
      padding: 16px 30px;
      font-size: 1.4rem;
    }
    
    .sound-btn:hover {
      background-color: #ffa235;
    }
    
    .game-complete {
      font-size: 2.5rem;
      color: #ff6b9d;
      margin: 25px 0;
      padding: 30px;
      background-color: #fff9fc;
      border-radius: 20px;
      border: 4px solid #ff9ebb;
      display: none;
    }
    
    .error-message {
      color: #ff6b6b;
      font-weight: bold;
      margin: 15px 0;
      font-size: 1.2rem;
    }
    
    .control-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 15px;
    }
    
    /* Mobil için responsive tasarım */
    @media (max-width: 1024px) {
      .container {
        width: 95vw;
        padding: 20px;
      }
      
      h1 {
        font-size: 2.2rem;
      }
      
      .question {
        font-size: 2.2rem;
        padding: 20px;
        min-height: 140px;
      }
      
      #answer {
        width: 280px;
        font-size: 1.6rem;
      }
      
      .letter-btn {
        width: 50px;
        height: 50px;
        font-size: 1.4rem;
      }
    }
    
    @media (max-width: 768px) {
      .container {
        min-height: auto;
      }
      
      .game-layout {
        flex-direction: column;
        gap: 20px;
        min-height: auto;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .question {
        font-size: 1.8rem;
        min-height: 120px;
        padding: 15px;
      }
      
      #answer {
        width: 250px;
        font-size: 1.4rem;
      }
      
      .letter-btn {
        width: 45px;
        height: 45px;
        font-size: 1.3rem;
      }
      
      button {
        font-size: 1.3rem;
        padding: 14px 25px;
      }
    }
    
    @media (max-width: 480px) {
      body {
        padding: 10px;
      }
      
      .container {
        padding: 15px;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .question {
        font-size: 1.6rem;
        min-height: 100px;
        padding: 12px;
      }
      
      #answer {
        width: 220px;
        font-size: 1.3rem;
      }
      
      .letter-btn {
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
      }
      
      .answer-letter {
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Harf ve Kelime Oyunu 🎉</h1>
    <p class="subtitle">Harfleri seç, kelimeleri yaz!</p>
    
    <div class="error-message" id="errorMessage" style="display: none;"></div>
    
    <div class="game-layout">
      <div class="left-panel">
        <div class="alphabet" id="alphabet">
          <!-- Türkçe alfabe butonları JavaScript ile eklenecek -->
        </div>
        
        <div class="selected-letters" id="selectedLetters">
          Henüz harf seçmediniz
        </div>
        
        <button id="startBtn">Oyunu Başlat</button>
      </div>
      
      <div class="right-panel">
        <div class="game-area" id="game">
          <div class="question-section">
            <div class="question-type" id="questionType"></div>
            
            <div class="question" id="question">
              <span class="speaker-icon">🔊</span>
              <span id="questionText">Sesi dinleyin ve cevabı yazın</span>
            </div>
          </div>
          
          <div class="answer-section">
            <div class="input-container">
              <input id="answer" placeholder="Cevabı buraya yaz">
              <button id="clearBtn">⌫</button>
            </div>
            <div class="selected-letters-answer" id="selectedLettersAnswer">
              <!-- Seçili harfler burada gösterilecek -->
            </div>
            
            <button id="submitBtn">
              <span class="tick-icon">✓</span> Cevapla
            </button>
            
            <button id="nextBtn">
              <span class="tick-icon">➡️</span> Sonraki Soru
            </button>
            
            <div class="control-buttons">
              <button class="sound-btn" id="repeatBtn">
                <span class="speaker-icon">🔊</span> Soruyu Tekrarla
              </button>
            </div>
            
            <div id="message"></div>
          </div>
          
          <div class="game-complete" id="gameComplete">
            🎉 Tebrikler! Tüm soruları tamamladınız! 🎉
          </div>
        </div>
        
        <div class="stats">
          <div class="stat-box">
            <div class="stat-value" id="currentStreak">0</div>
            <div class="stat-label">Doğru Serisi</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="longestStreak">0</div>
            <div class="stat-label">En Uzun Seri</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="wrongMark">❌</div>

  <!-- Sesler -->
  <audio id="clap" src="Sound/applause.mp3" preload="auto"></audio>
  <audio id="error" src="Sound/wrong.mp3" preload="auto"></audio>

  <canvas class="fireworks"></canvas>

  <script>
    // Türkçe alfabe (büyük harfler)
    const turkishAlphabet = [
      'A', 'B', 'C', 'Ç', 'D', 'E', 'F', 'G', 'Ğ', 'H', 
      'I', 'İ', 'J', 'K', 'L', 'M', 'N', 'O', 'Ö', 'P', 
      'R', 'S', 'Ş', 'T', 'U', 'Ü', 'V', 'Y', 'Z'
    ];

    // Büyük kelime listesi
    const turkceKelimeler = [
      "OCAK", "PAZAR", "ABİ", "ABLA", "AÇI", "ADA", "ADALET", "ADİL", "AFİŞ", "AĞAÇ",
      "AĞIRLIK", "AİLE", "AKARSU", "AKŞAM", "AL", "ALAN", "ALÇAK", "ALET", "ALIŞVERİŞ",
      "ALMANCA", "ALTIN", "AMAÇ", "AMCA", "AMELİYAT", "AN", "ANAHTAR", "ANAOKULU",
      "ANAYASA", "ANI", "ANLAMA", "ANLAŞMA", "ANLATMA", "ANNE", "ANSİKLOPEDİ", "ARABA",
      // ... (kelime listesi aynı kalacak, kısaltıyorum)
      "ZOR"
    ];

    let letters = [];
    let target = "";
    let currentStreak = 0;
    let longestStreak = 0;
    let isWaitingForNextRound = false;
    let questionCounter = 0;
    let usedQuestions = [];
    let availableQuestions = [];

    const startBtn = document.getElementById("startBtn");
    const submitBtn = document.getElementById("submitBtn");
    const nextBtn = document.getElementById("nextBtn");
    const repeatBtn = document.getElementById("repeatBtn");
    const clearBtn = document.getElementById("clearBtn");
    const answerInput = document.getElementById("answer");
    const questionText = document.getElementById("questionText");
    const questionType = document.getElementById("questionType");
    const selectedLettersElement = document.getElementById("selectedLetters");
    const selectedLettersAnswerElement = document.getElementById("selectedLettersAnswer");
    const currentStreakElement = document.getElementById("currentStreak");
    const longestStreakElement = document.getElementById("longestStreak");
    const alphabetElement = document.getElementById("alphabet");
    const gameCompleteElement = document.getElementById("gameComplete");
    const errorMessageElement = document.getElementById("errorMessage");

    // Sayfa yüklendiğinde
    window.addEventListener('DOMContentLoaded', function() {
      createAlphabetButtons();
    });

    // Türkçe alfabe butonlarını oluştur
    function createAlphabetButtons() {
      turkishAlphabet.forEach(letter => {
        const button = document.createElement('button');
        button.className = 'letter-btn';
        button.textContent = letter;
        button.dataset.letter = letter;
        button.addEventListener('click', toggleLetterSelection);
        alphabetElement.appendChild(button);
      });
    }

    // Harf seçimi/deseçimi
    function toggleLetterSelection(e) {
      const button = e.target;
      const letter = button.dataset.letter;
      
      if (button.classList.contains('selected')) {
        button.classList.remove('selected');
        letters = letters.filter(l => l !== letter);
      } else {
        button.classList.add('selected');
        letters.push(letter);
      }
      
      updateSelectedLettersDisplay();
      updateAnswerLettersDisplay();
    }

    // Seçili harfleri göster
    function updateSelectedLettersDisplay() {
      if (letters.length === 0) {
        selectedLettersElement.textContent = "Henüz harf seçmediniz";
      } else {
        selectedLettersElement.textContent = `Seçili harfler: ${letters.join(', ')}`;
      }
    }

    // Cevap kutusu yanında seçili harfleri göster
    function updateAnswerLettersDisplay() {
      selectedLettersAnswerElement.innerHTML = '';
      
      letters.forEach(letter => {
        const letterElement = document.createElement('div');
        letterElement.className = 'answer-letter';
        letterElement.textContent = letter;
        letterElement.addEventListener('click', () => {
          answerInput.value += letter;
          answerInput.focus();
        });
        selectedLettersAnswerElement.appendChild(letterElement);
      });
    }

    // Oyunu başlat
    function startGame() {
      if (letters.length === 0) {
        alert("Lütfen en az bir harf seçin!");
        return;
      }
      
      document.getElementById("game").style.display = "flex";
      currentStreak = 0;
      questionCounter = 0;
      usedQuestions = [];
      updateStreakDisplay();
      isWaitingForNextRound = false;
      nextBtn.style.display = 'none';
      gameCompleteElement.style.display = 'none';
      errorMessageElement.style.display = 'none';
      
      // Kullanılabilir soruları hazırla (SADECE KELİME SORULARI)
      prepareAvailableQuestions();
      newRound();
    }

    // Kullanılabilir soruları hazırla - SADECE KELİME
    function prepareAvailableQuestions() {
      availableQuestions = [];
      
      // SADECE kelime soruları
      const possibleWords = turkceKelimeler.filter(w =>
        w.split("").every(harf => letters.includes(harf))
      );
      
      possibleWords.forEach(word => {
        availableQuestions.push({
          type: 'kelime',
          value: word
        });
      });
      
      // Soruları karıştır
      availableQuestions = shuffleArray(availableQuestions);
    }

    // Dizi karıştırma
    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }

    // Yeni tur - SADECE KELİME SORULARI
    function newRound() {
      if (availableQuestions.length === 0) {
        // Tüm sorular bitti
        gameCompleteElement.style.display = 'block';
        submitBtn.style.display = 'none';
        nextBtn.style.display = 'none';
        questionText.textContent = "Tüm sorular tamamlandı!";
        questionType.textContent = "";
        return;
      }
      
      questionCounter++;
      
      // Her zaman kelime sorusu
      const selectedQuestion = availableQuestions.shift();
      usedQuestions.push(selectedQuestion);
      
      target = selectedQuestion.value;
      updateQuestionDisplay();
      
      answerInput.value = "";
      document.getElementById("message").textContent = "";
      answerInput.focus();
      isWaitingForNextRound = false;
      submitBtn.style.display = 'flex';
      nextBtn.style.display = 'none';
    }

    // Soru görüntüsünü güncelle
    function updateQuestionDisplay() {
      speak(`Bu kelimeyi yaz: ${target}`, false);
      questionText.textContent = "Bir kelime yazmanız isteniyor...";
      questionType.textContent = "Kelime Sorusu";
    }

    // Cevabı kontrol et
    function checkAnswer() {
      if (isWaitingForNextRound) return;
      
      let answer = answerInput.value.toUpperCase().trim();
      
      if (answer === "") {
        document.getElementById("message").textContent = "Lütfen bir cevap yazın!";
        document.getElementById("message").className = "wrong";
        return;
      }
      
      if (answer === target) {
        document.getElementById("message").textContent = "Doğru! 🎉";
        document.getElementById("message").className = "correct";
        
        // Alkış sesini çal
        const clapSound = document.getElementById("clap");
        clapSound.currentTime = 0;
        clapSound.play().catch(e => console.log('Ses çalınamadı:', e));
        
        launchFireworks();
        
        currentStreak++;
        if (currentStreak > longestStreak) {
          longestStreak = currentStreak;
        }
        updateStreakDisplay();
        
        isWaitingForNextRound = true;
        submitBtn.style.display = 'none';
        nextBtn.style.display = 'flex';
      } else {
        document.getElementById("message").textContent = "Yanlış! Tekrar deneyin.";
        document.getElementById("message").className = "wrong";
        
        // Hata sesi çal
        const errorSound = document.getElementById("error");
        errorSound.currentTime = 0;
        errorSound.play().catch(e => console.log('Ses çalınamadı:', e));
        
        showWrongMark();
        
        currentStreak = 0;
        updateStreakDisplay();
        
        isWaitingForNextRound = true;
        setTimeout(() => {
          isWaitingForNextRound = false;
          answerInput.focus();
        }, 2000);
      }
    }

    // Cevabı temizle
    function clearAnswer() {
      answerInput.value = "";
      answerInput.focus();
    }

    // Sonraki soru butonu
    function nextQuestion() {
      newRound();
    }

    // Soruyu tekrarla
    function repeatQuestion() {
      updateQuestionDisplay();
    }

    // Türkçe seslendirme
    function speak(text, isLetter) {
      // Tarayıcı desteği kontrolü
      if (!('speechSynthesis' in window)) {
        errorMessageElement.textContent = 'Tarayıcınız ses sentezleme özelliğini desteklemiyor.';
        errorMessageElement.style.display = 'block';
        return;
      }
      
      // Önceki seslendirmeyi durdur
      window.speechSynthesis.cancel();
      
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "tr-TR";
      utter.rate = 0.7;
      utter.pitch = 1;
      
      utter.onerror = (event) => {
        console.error('Seslendirme hatası:', event.error);
        errorMessageElement.textContent = 'Seslendirme hatası. Soruyu tekrarla butonunu kullanın.';
        errorMessageElement.style.display = 'block';
      };
      
      window.speechSynthesis.speak(utter);
    }

    // Seri sayacını güncelle
    function updateStreakDisplay() {
      currentStreakElement.textContent = currentStreak;
      longestStreakElement.textContent = longestStreak;
    }

    // ❌ işaretini göster
    function showWrongMark() {
      const wrongMark = document.getElementById("wrongMark");
      wrongMark.style.display = "block";
      setTimeout(() => {
        wrongMark.style.display = "none";
      }, 1500);
    }

    // Havai fişek animasyonu
    function launchFireworks() {
      const canvas = document.querySelector(".fireworks");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      let particles = [];
      for (let i = 0; i < 80; i++) {
        particles.push({
          x: canvas.width/2,
          y: canvas.height/2,
          angle: Math.random() * 2 * Math.PI,
          speed: Math.random() * 4 + 2,
          radius: Math.random() * 2 + 2,
          color: `hsl(${Math.random()*360},100%,50%)`,
          life: 80
        });
      }

      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => {
          p.x += Math.cos(p.angle) * p.speed;
          p.y += Math.sin(p.angle) * p.speed;
          p.life--;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.radius, 0, 2 * Math.PI);
          ctx.fillStyle = p.color;
          ctx.fill();
        });
        particles = particles.filter(p => p.life > 0);
        if (particles.length > 0) {
          requestAnimationFrame(animate);
        } else {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
      }
      animate();
    }

    // Event listener'ları ekle
    startBtn.addEventListener("click", startGame);
    submitBtn.addEventListener("click", checkAnswer);
    nextBtn.addEventListener("click", nextQuestion);
    repeatBtn.addEventListener("click", repeatQuestion);
    clearBtn.addEventListener("click", clearAnswer);
    answerInput.addEventListener("keyup", function(e) {
      if (e.key === "Enter" && !isWaitingForNextRound) {
        checkAnswer();
      }
    });
  </script>
</body>
</html>